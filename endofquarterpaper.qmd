---
title: "Changes in Patterns of Geometric Sign Groupings as a Model of Social Dynamics Across Aurignacian Phases"
author: Sophie Cooper
format: html
echo: false
execute: 
  warning: false
bibliography: references.bib
link-citations: true
---

# Introduction

The Upper Paleolithic period experienced a rise in more complex social organizations across Europe [@Boyd_Silk_2020] coupled with biological evolution. Another distinctive quality of the Upper Paleolithic is the large rise in artwork, both parietal and mobile. Archaeologists have frequently relied upon that artwork as a proxy for cultural difference in order to understand the shifting patterns of social organization and diversity of the Upper Paleolithic [@baker2024evidence, @Sauvet_2018, @Kuhn_Stiner_2007, @Vanhaeren_d]. Considered to be the starting point of the Upper Paleolithic, the Aurignacian technocomplex (ca. 43 - 30 k BP) is commonly linked to the dispersal of Homo sapiens across Western Eurasia, and is characterized by lithic and osseus markers [@Tejero_Grimaldi_2015; @Tartar_2012], some of which are decorated with geometric signs [@dutkiewicz2020]. In this paper, we investigate the social organization dynamics by analyzing the distribution and variation of geometric sign types found on mobile objects from the Upper Paleolithic in Europe across four phases of the Aurignacian period.

Social organization dynamics of the Upper Paleolithic have previously been explored using statistical analyses of objects to understand patterns of cultural groups. Multivariate analyses of beads from the Gravettian technocomplex suggests an east to west cline of nine cultural groups [@baker2024evidence]. Seriation analysis, PCoA, and network analysis were used to identify the groups from 134 discrete bead types recovered from both burial and occupation sites. To validate their claims of cultural groups, @baker2024evidence used a Mantel test to evaluate an isolation-by-distance hypothesis, which proposes that cultural difference can be primarily explained by geographic distance, finding that geographic distance alone did not solely account for the bead distribution. The nine geographically discrete groups encompass the regions of eastern, northwestern and central Europe, the northern and southern Iberian peninsula, southern and northern Italy, and the eastern and western Mediterranean regions.

Similar analyses of personal ornament types from the Aurignacian technocomplex identified fourteen geographically cohesive groups [@Vanhaeren_d]. Drawing on ethnographic studies that show how body decoration and ornamentation indicates ethno-linguistic identity, @Vanhaeren_d used Aurignacian personal ornamentation as a proxy for ethno-linguistic diversity. They analyzed 157 distinct ornament types from 98 Aurignacian sites in Europe and the Near East. Geographically cohesive groups sharing similar ornament type associations were identified by seriation, correspondence, and GIS analyses. These groups sweep counter-clockwise throughout western France, northern Spain, the Pyrenees, and the Mediterranean region. @Vanhaeren_d interpret the variation in personal ornament types as evidence of long-lasting cultural differences and as robustly establishing the ethno-linguistic diversity of the Aurignacian.

Cultural difference has also been identified from geometric signs in Upper Paleolithic parietal art from the Cantabrian region of Spain [@Sauvet_2018]. Forty-two quadrilateral geometric signs from four cave sites, likely associated with the Magdalenian period, spanning a distance of 30 kilometers were recorded. Multivariate analysis of 45 morphological characteristics of the signs revealed two clusters. To interpret these clusters, @Sauvet_2018 draw on case studies of geometric signs as identity markers, including South African engraved ostrich shells from 60 k BP, maker's marks on Gallo-Roman pottery, and 19th century French craft guild members' personal marks. Using these case studies as analogies, @Sauvet_2018 interpret the Magdalenian geometric signs as identity markers, and the two clusters as representative of cultural groups.

In this study, we extend the use of geometric signs as identity markers to investigate cultural groups in the Aurignacian period. The Aurignacian period spans roughly 43 - 30 k BP, and is largely characterized by material culture indicators, such as carinated scrapers, small-flake tools and split-based bone and ivory tools, as well as an ongoing evolutionary shift from Neanderthals to early modern humans [@Chu_Richter_2020]. The Aurignacian can be divided into phases which are mainly distinguished by shifts in material culture; Proto, Early, Evolved, and Late Aurignacian [@Tartar_2015], as can be seen in @tbl-aur-table. @Shao_Limberg_Klein_Wegener_Schmidt_Weniger_Hense_Rostami_2021 divided the Aurignacian into two main phases, Aur-P1 (Proto/Early), which corresponds with the time period of 43–37 k BP, and Aur-P2 (Evolved/Late), which corresponds with the time periods 37-32 k BP. @Banks_dErrico_Zilhao_2013 used Bayesian modeling methods to further divide Aur-P1 into the Proto and Early Aurignacian, placing the Proto-Aurignacian at 41.5 - 39.9 k BP, and the early Aurignacian at 39.8 - 37.8 k BP. They found that the Proto-Aurignacian occurs during the Greenland Interstadials (GI) 9 and 10, periods of climatic amelioration, while the Early Aurignacian began with the Henrich Stadial, which is characterized by dry and arid conditions, and ends with GI 8.

```{r}
#| label: tbl-aur-table
#| tbl-cap: "Summary of chronological, cultural and environmental characteristics of Aurignacian periods [@Banks_dErrico_Zilhao_2013;  @Shao_Limberg_Klein_Wegener_Schmidt_Weniger_Hense_Rostami_2021; @Chu_Richter_2020; @Fletcher_Sánchez]"
#| tbl-cap-location: bottom

library(knitr)
library(tidyverse)
library(readxl)

aur_table <- read_excel("data/aurignacian-periods.xlsx")

kable(aur_table)
```

We hypothesize that these phases, and the environmental changes across the Aurignacian, may correspond to changes in social dynamics of cultural groups, as represented by patterns in the distribution of geometric signs. We aim to address the following questions: How do grouping dynamics of geometric signs change across the four phases of the Aurignacian? How do the groupings vary in diversity, size, connectivity, and boundaries? Lastly, what do the patterns tell us about dynamics of social organization throughout the Aurignacian? We answer these questions by first identifying clusters within each phase using seriation and network analyses. We then test the strength of the clusters using modularity and perMANOVA tests. Lastly, we use Mantel tests to evaluate the null hypothesis of isolation-by-distance for each phase.

# Materials and Methods

```{r}
## clean the data
library(magrittr)
library(rcarbon)
signbase_full <- read_csv("data/signBase_Version1.0.csv")
nsites <- signbase_full %>% 
  pull(site_name ) %>% 
  unique() %>% 
  length()
nartifacts <- nrow(signbase_full)
ncountries <- signbase_full %>% 
  pull(country) %>% 
  unique() %>% 
  length()
nsigntypes <- ncol(signbase_full)

signbase_full_clean <- signbase_full %>%  # 511 rows
  filter(site_name != "Willendorf",
         site_name != "Riparo di Fontana Nuova",
         site_name != "Muralovka",
         site_name != "Shanidar Cave",
         site_name != "Hayonim Cave",
         site_name != "El Salitre",
         site_name != "Grotte De La Princesse Pauline",
         site_name != "Šandalja II") %>% 
  dplyr::select(-other, -rectangle) %>% 
  mutate(longitude = ifelse(site_name == "Riparo Bombrini", 7.437500, longitude)) %>% 
  mutate(latitude = ifelse(site_name == "Riparo Bombrini", 43.77083, latitude))

signbase_years <- signbase_full_clean %>%
  drop_na(date_bp_max_min) %>% 
  mutate(date_bp_max_min = str_replace_all(date_bp_max_min, "\\+\\/\\-", "±")) %>% 
  mutate(date_bp_max_min = str_replace_all(date_bp_max_min, "\\+", "±")) %>% 
  separate(date_bp_max_min,
           sep = " - ",
           c("date_bp_max", "date_bp_min"),
           remove = FALSE) %>% 
  mutate(date_bp_max = ifelse(str_detect(date_bp_max, "\\/"),
                              str_extract(date_bp_max, ".*?(?=\\/)"),
                              date_bp_max)) %>% 
  mutate(date_bp_min = ifelse(str_detect(date_bp_min, "\\/"),
                              str_extract(date_bp_min, ".*?(?=\\/)"),
                              date_bp_min)) %>% 
  separate(date_bp_max,
           sep = "±",
           c("date_bp_max_age",
             "date_bp_max_error")) %>% 
  separate(date_bp_min,
           sep = "±",
           c("date_bp_min_age",
             "date_bp_min_error")) %>% 
  drop_na(date_bp_max_age,
          date_bp_max_error) %>% 
  mutate(date_bp_max_age = parse_number(date_bp_max_age),
         date_bp_max_error = parse_number(date_bp_max_error))

signbase_years_cal <- 
  rcarbon::calibrate(signbase_years$date_bp_max_age,
                     signbase_years$date_bp_max_error,
                     verbose = FALSE) %>% 
  summary() %>% 
  data_frame()

signbase_years$MedianBP <- signbase_years_cal$MedianBP

signbase_full_clean <- signbase_full_clean %>% 
  inner_join(signbase_years %>% 
              dplyr::select(object_id, MedianBP))

signbase_full_clean <- signbase_full_clean %>%
  mutate(time_period = case_when((MedianBP > 41499) ~ "transitional",
                                 (MedianBP > 39799) ~ "proto_aurignacian",
                                 (MedianBP > 37799) ~ "early_aurignacian",
                                 (MedianBP > 31999) ~ "evolved_aurignacian"))

signbase_full_clean <- signbase_full_clean %>% 
  mutate(sign_total = rowSums((signbase_full_clean [,25:53]))) %>% 
  filter(sign_total > 0)

nsites_clean <- signbase_full_clean %>% 
  pull(site_name ) %>% 
  unique() %>% 
  length()
nartifacts_clean <- nrow(signbase_full_clean)
ncountries_clean <- signbase_full_clean %>% 
  pull(country) %>% 
  unique() %>% 
  length()
nsigntypes_clean <- nsigntypes - 1

pretty_print_dates <- 
  function(x) formatC(x, 
                      decimal.mark=".", 
                      big.mark=",", 
                      digits = 0, 
                      format = "f")

date_min <- signbase_years_cal %>% 
  pull(MedianBP) %>% 
  min()
date_max <- signbase_years_cal %>% 
  pull(MedianBP) %>% 
  max()
date_range <- date_max - date_min
date_min_pretty <- pretty_print_dates(date_min)
date_max_pretty <- pretty_print_dates(date_max)
date_range_pretty <- pretty_print_dates(date_range)
```

```{r}

lat_long_df <- signbase_full_clean %>% 
  dplyr::select(site_name, longitude, latitude) %>% 
  distinct(site_name, .keep_all = TRUE)

trans_df<- signbase_full_clean %>% 
  filter(time_period == "transitional") %>% 
  mutate(longitude = as.character(longitude),
         latitude = as.character(latitude)) 

trans_object_num <- trans_df %>% 
  group_by(site_name) %>%
  summarise(nobjects = n())

trans_unique_data <- trans_df %>% 
  group_by(site_name) %>% 
  summarize(across(where(is.numeric), sum)) %>% 
  left_join(lat_long_df) %>% 
  left_join(trans_object_num) %>% 
  mutate(time_period = "transitional") 

proto_df <- signbase_full_clean %>% 
  filter(time_period == "proto_aurignacian") %>% 
  mutate(longitude = as.character(longitude),
         latitude = as.character(latitude))

proto_object_num <- proto_df %>% 
  group_by(site_name) %>%
  summarise(nobjects = n())
  
proto_unique_data <- proto_df %>% 
  group_by(site_name) %>%
  summarize(across(where(is.numeric), sum)) %>% 
  left_join(lat_long_df) %>% 
  left_join(proto_object_num) %>% 
  mutate(time_period = "proto_aurignacian")

early_df <- signbase_full_clean %>% 
  filter(time_period == "early_aurignacian") %>% 
  mutate(longitude = as.character(longitude),
         latitude = as.character(latitude))

early_object_df <- early_df %>% 
  group_by(site_name) %>%
  summarise(nobjects = n())

early_unique_data <- early_df %>% 
  group_by(site_name) %>%
  summarize(across(where(is.numeric), sum)) %>% 
  left_join(lat_long_df) %>% 
  left_join(early_object_df) %>% 
  mutate(time_period = "early_aurignacian")
  

evolved_df <- signbase_full_clean %>% 
  filter(time_period == "evolved_aurignacian") %>% 
  mutate(longitude = as.character(longitude),
         latitude = as.character(latitude))

evolved_object_df <- evolved_df %>% 
  group_by(site_name) %>%
  summarise(nobjects = n())
  
evolved_unique_data  <- evolved_df %>% 
  group_by(site_name) %>%
  summarize(across(where(is.numeric), sum)) %>% 
  left_join(lat_long_df) %>% 
  left_join(evolved_object_df) %>% 
  mutate(time_period = "evolved_aurignacian")


trans_artifact_data <- trans_unique_data %>% 
  column_to_rownames("site_name") %>% 
  dplyr::select(line:star) %>% 
  select_if(~ !is.numeric(.) || sum(.) != 0)


proto_artifact_data <- proto_unique_data %>% 
  column_to_rownames("site_name") %>% 
  dplyr::select(line:star) %>% 
  select_if(~ !is.numeric(.) || sum(.) != 0)

early_artifact_data <- early_unique_data %>% 
  column_to_rownames("site_name") %>% 
  dplyr::select(line:star) %>% 
  select_if(~ !is.numeric(.) || sum(.) != 0)

evolved_artifact_data <- evolved_unique_data %>% 
  column_to_rownames("site_name") %>% 
  dplyr::select(line:star) %>% 
  select_if(~ !is.numeric(.) || sum(.) != 0)

# BM: a little simpler and less typings using %in% 
trans_unique_data <- trans_unique_data %>% 
  mutate(group = case_when(site_name %in% c("Pod Hradem", "Fumane", "Geissenklösterle") ~ "1",
                           site_name %in% c("El Castillo", "Hohle Fels", "Labeko Koba") ~ "2"))

proto_unique_data <- proto_unique_data %>% 
  mutate(group = case_when((site_name == "Gatzarria" | 
                              site_name == "Hohlenstein-Stadel" | 
                              site_name == "Mladeč" | 
                              site_name == "Abri Pataud") ~ "1",
                           (site_name == "Geissenklösterle" |
                              site_name == "Grotte du Renne" |
                              site_name == "Vogelherd" |
                              site_name == "Spy" |
                              site_name == "La Ferrassie"|
                               site_name == "Les Cottés") ~ "2"))

early_unique_data <- early_unique_data %>% 
  mutate(group = case_when((site_name == "Grottes de Fonds-de-Forêt" |
                              site_name == "Riparo Bombrini"|
                              site_name == "Grotte de la Verpillière I"|
                              site_name == "Vindija Cave") ~ "1",
                           (site_name == "Hohle Fels" | 
                              site_name == "Solutré" |
                              site_name == "Castanet"|
                              site_name == "Cellier" | 
                              site_name == "Blanchard"|
                              site_name == "Trou al'Wesse") ~ "2"))


evolved_unique_data <- evolved_unique_data %>% 
  mutate(group = case_when((site_name == "Les Rois" |
                              site_name == "Gargas" |
                              site_name == "La Viña"|
                              site_name ==  "Sirgenstein Cave"|
                              site_name == "Vindija Cave") ~ "1",
                           (site_name == "Bockstein-Törle"|
                              site_name == "Vogelherd" |
                              site_name == "Hohle Fels"|
                              site_name == "Trou Magrite") ~ "2"))



time_unique_data_full <-rbind(trans_unique_data, proto_unique_data, 
                              early_unique_data, evolved_unique_data)

time_unique_data_full$time_period <- factor(time_unique_data_full$time_period, 
                                            levels = c("transitional", "proto_aurignacian", 
                                                       "early_aurignacian", "evolved_aurignacian"), 
                                            labels = c("Transitional", "Proto-Aurignacian",
                                                       "Early Aurignacian", "Evolved Aurignacian"))


trans_site_count <- nrow(trans_unique_data)
trans_sign_count <- ncol(trans_artifact_data)
proto_site_count <- nrow(proto_unique_data)
proto_sign_count <- ncol(proto_artifact_data)
early_site_count <- nrow(early_unique_data)
early_sign_count <- ncol(early_artifact_data)
evolved_site_count <- nrow(evolved_unique_data)
evolved_sign_count <- ncol(evolved_artifact_data)

nvogel <- nrow(signbase_full_clean %>% 
                 filter(site_name == "Vogelherd"))

artifact_count_df <- signbase_full_clean %>% 
  group_by(site_name) %>% 
  summarise(artifact_count = n())

artifact_count_median <- median(artifact_count_df$artifact_count)
```

```{r}
# mantel abundance
library(vegan)

set.seed(200)

artifact_data <- time_unique_data_full %>% 
  column_to_rownames("id") %>% 
  dplyr::select(line:star) 

# BM: not sure why the id column was also selected here? I moved it to rownames
object_euc_data <- time_unique_data_full %>%
    column_to_rownames("id") %>% 
    dplyr::select(nobjects) %>% 
    dist(method = "euclidean")

# BM: Ensure binary data as input to jaccard distance
artifact_data_bin <- 
artifact_data %>% 
  mutate_all(~ as.numeric(. > 0))

jac_full <- vegan::vegdist(artifact_data_bin, method = "jaccard", binary = TRUE) 

object_count_mantel <- vegan::mantel(object_euc_data, jac_full, permutations = 1000)
p_value_object_abundance_correlation <- round(object_count_mantel$signif, 3)
r_value_object_abundance_correlation <- round(object_count_mantel$statistic, 3)

sign_euc_data <- artifact_data %>% 
  mutate(sign_count = rowSums(.)) %>% 
  dplyr::select(sign_count) %>% 
  dist(method = "euclidean")

sign_count_mantel <- vegan::mantel(sign_euc_data, jac_full, permutations = 1000)
p_value_sign_abundance_correlation <- round(sign_count_mantel$signif, 3)
r_value_sign_abundance_correlation <- round(sign_count_mantel$statistic, 3)

## mantel chronological
chron_df <- signbase_full_clean %>% 
  column_to_rownames("id") %>% 
  dplyr::select(MedianBP) %>% 
  dist( method = "euclidean")

chron_sign_df <- signbase_full_clean %>% 
  column_to_rownames("id") %>% 
  dplyr::select(line:star) %>% 
  # BM: Ensure binary data as input to jaccard distance
  mutate_all(~ as.numeric(. > 0)) %>% 
  vegdist("jaccard")

chron_mantel <- vegan::mantel(chron_df, chron_sign_df, permutations = 1000)

chron_p <- round(chron_mantel$signif, 3)
chron_r <- round(chron_mantel$statistic, 3)

## chron permanova
perman_chron <- adonis2(jac_full ~ as.factor(time_unique_data_full$time_period), 
                    method = "jaccard",
                    sqrt.dist = TRUE)

perman_chron <- perman_chron %>% 
    data_frame() %>% 
    slice_head()

```

## Data

Our data come from SignBase 1.0, an open-access collection of geometric signs on mobile objects from Upper Paleolithic Europe. SignBase 1.0 is a record of objects noting only the presence or absence of each sign on the object, without details of the quantity or sequence of individual signs on a given object. We used the identification of sign types provided by SignBase's curators [@dutkiewicz2020]. The data set consists of `r nartifacts` objects found at `r nsites` sites in `r ncountries` countries, and records `r nsigntypes` geometric sign types. We excluded signs if they fell under the "other" category, due to the wide range of potential possibilities. We also excluded seven sites from the sample (only one sign present: Willendorf; extreme geographic distance from the other sites: Riparo di Fontana Nuova, Muralovka, Shanidar Cave, and Hayonim Cave; dated much later than the rest of the assemblages: Grotte De La Princesse Pauline and Šandalja II). These exclusions resulted in a sample of `r nartifacts_clean` objects found at `r nsites_clean` sites in `r ncountries_clean` countries, and `r nsigntypes_clean` sign types used in this study (@fig-site-map).

```{r fig.height= 9, fig.width=10}
#| label: fig-site-map
#| fig-cap: "A: Map of sites in each Aurignacian phase that contain geometric signs on mobile objects. B: Abundance of signs over time, phases indicated by colours. C. Distribution of object count by site"
#| fig-height: 10

library(rnaturalearth)
library(rnaturalearthdata)
library(ggrepel)
library(sf)
library(ggpubr)
library(cowplot)

signbase_full_clean$time_period <-
  factor(
    signbase_full_clean$time_period,
    levels = c(
      "transitional",
      "proto_aurignacian",
      "early_aurignacian",
      "evolved_aurignacian"
    ),
    labels = c(
      "Transitional",
      "Proto-Aurignacian",
      "Early Aurignacian",
      "Evolved Aurignacian"
    )
  )

  
signcount_barplot <- ggplot(signbase_full_clean) +
  aes(x = MedianBP, fill = time_period) +
  geom_bar(width = 150) +
  scale_x_reverse() +
  labs(fill = "Time period") +
  theme(legend.key.size = unit(0.5, "cm")) +
  theme_minimal() +
  scale_fill_discrete(guide = "none") +
  xlab("Years cal BP")

objectcount_barplot <- 
ggplot(artifact_count_df) +
  aes(reorder(site_name, artifact_count),
      artifact_count) +
  geom_col() +
  coord_flip() +
    theme_minimal() +
    xlab("") +
    ylab("Object count")
  
signbase_sf <- time_unique_data_full  %>% 
  st_as_sf(coords = c("longitude", "latitude"),
           remove = FALSE,
           crs = 4326)

world <- ne_countries(scale = "medium", returnclass = "sf")

Europe <- world[which(world$continent == "Europe"),]

sign_map <- ggplot(Europe) +
  geom_sf() +
  geom_sf(data = signbase_sf, aes(color = time_period)) +
  scale_colour_discrete(guide = "none")+
  coord_sf(xlim = c(-10,30), 
           ylim = c(35,53), 
           expand = FALSE) +
  geom_text_repel(data = signbase_sf,
                  aes(x = longitude ,
                      y = latitude,
                      label = site_name),
                  max.overlaps = 30,
                  size = 2, 
                  bg.color = "white",
                  bg.r = 0.25) +
  theme_minimal() +
  facet_wrap(~time_period, ) +
  theme(axis.text = element_blank(),
        axis.title = element_blank(),
        strip.text = element_text(size = 10))

maps_bar_plots <- 
plot_grid(sign_map,
          plot_grid(signcount_barplot,
                    objectcount_barplot,
                    rel_widths = c(1, 0.5),
                    labels = c("B", "C")), 
          ncol = 1, 
          scale = c(1, 1),
          rel_heights = c(1, 0.5),
          align = "vh", 
          labels = "A",
          axis = "lr")

ggsave(maps_bar_plots, 
      filename =  "map-and_hist-plot.png",
       h = 10, w = 10,
       bg = "white")

knitr::include_graphics("map-and_hist-plot.png")

```

The distribution of objects across sites is highly skewed, with the median number of objects as `r artifact_count_median`, but Vogelherd has `r nvogel`. To minimize the influence of this skewed distribution, we followed @Lycett_2019 in using presence/absence data for each sign at each site, reducing the effect of variation in object count between sites. A Mantel test between a Euclidean object abundance distance matrix and a Jaccard distance matrix of sign types indicated that there was no significant correlation between object abundance and sign type distribution (R = `r r_value_object_abundance_correlation`, p = `r p_value_object_abundance_correlation`).

Ages of the objects were determined by calibrating the uncalibrated ages provided by SignBase, using the rcarbon package [@Crema_Bevan_2021]. The calibrated radiocarbon dates of the sampled data range from approximately `r date_min_pretty` BP to `r date_max_pretty` BP, spanning an overall time range of `r date_range_pretty` years. We assigned each object to a chronological phase following the date ranges recorded in @tbl-aur-table. The Transitional phase has `r trans_site_count` sites and `r trans_sign_count` sign types, the Proto-Aurignacian has `r proto_site_count` sites and `r proto_sign_count` sign types, the Early Aurignacian has `r early_site_count` sites and `r early_sign_count` sign types, and the Evolved Aurignacian has `r evolved_site_count` sites and `r evolved_sign_count` sign types. A Mantel test to evaluate the correlation between distance in time and distribution of sign types found a statistically significant correlation (R = `r chron_r`, p = `r chron_p`). This confirms that our assumption that a meaningful change in sign types occurs over time during the Aurignacian period.

## Cultural Group Detection Using Seriation and Network Analysis

Seriation analysis is the arrangement of data into a linear order to reveal patterns [@Hahsler_Hornik_Buchta]. We used the Brower-Kile [-@Brower_Kile_1988] seriation algorithm from the seriation package [@seriation_pckge], in which a unidimensional sequence is generated by reordering the rows and columns to group the presences along the diagonal. To investigate connectivity among clusters of sites in the seriation solution, we used network analysis to represent and quantify the relationship between sites [@Mills_2017]. In our network analysis, each node is a site, and each edge is a measure of sign type distribution similarity. We input the Jaccard similarity matrix for each phase, computed the network statistics, and plotted the results with the Fruchterman-Reingold layout [@Fruchterman_Reingold_1991], a force-directed graph layout for uniform edge lengths. Network analysis was performed using the vegan [@Vegan2001], statnet [@statnet_package] and igraph [@igraph_package] packages.

## Modularity and PerMANOVA for Cultural Group Strength

To evaluate the strength of the groupings found in the seriation and network analyses, we used modularity and perMANOVA tests. The modularity test is a community structure network detection method, and quantifies the randomness of the groupings by measuring the fraction of the edges in the network that fall within groups, minus the expected value if the edges were placed at random [@Newman_2006; @Newman_Girvan_2004]. The results are expressed in a score of 0 to 1, with 0 meaning no significant subgroups, and 1 meaning perfect groupings. PerMANOVA quantifies the level of variation between groups versus the level of variation within groups [@Anderson_2017]. The results are expressed by an R statistic, which quantifies how much of the variation in sign distribution can be explained by group membership, and a p-value, which quantifies the probability of obtaining the observed difference if the null hypothesis were true (we use an alpha value of 0.05 for the threshold of statistical significance). The modularity test and perMANOVA were performed using the vegan [@Vegan2001] and igraph [@igraph_package] packages.

## Effects of Geographic Distance Using Mantel Tests

The isolation-by-distance framework proposes that cultural difference can be primarily explained by geographic distance [@Lycett_2019]. If cultural difference can be solely explained by geographic distance, then we would see similarity in sign type distribution decreasing as geographic distance increases. To test this, we determined the correlation between sign distribution and geography using Mantel tests, run with a geographic distance matrix and a Jaccard similarity matrix. The test seeks to determine the level of correspondence between the matrices through permutational evaluation of the null distribution [@Mantel_Smouse], (here 1000 permutations), producing a Mantel R statistic and a p-value. The R statistic falls between -1, meaning a strong negative correlation, and 1, meaning a strong positive correlation, while a value of 0 means no correlation. The p-value quantifies the probability of obtaining the observed correlation if the null hypothesis were true (we use an alpha value of 0.05 for the threshold of statistical significance). The Mantel tests were performed using the vegan package [@Vegan2001]

# Results

## Cultural Group Detection

```{r}
library(ggraph)
library(statnet)
library(ape)
library(igraph)

mplot <- function(x, ..., fill_colour = "black", title = NULL, row_labels = NULL, col_labels = NULL, palette_colors = NULL) {
  d <- data.frame(
    x = rep(1:ncol(x), each = nrow(x)),
    y = rep(nrow(x):1, ncol(x)),
    z = as.integer(x)
  )
  
  if (!is.null(palette_colors)) {
    d$palette_colors <- rep(palette_colors, ncol(x))
  }
  
  if (is.null(col_labels)) col_labels <- colnames(x)
  if (is.null(row_labels)) row_labels <- rev(rownames(x))
  
  p <- ggplot(d, aes(x, y)) +
    geom_tile(col = "grey50", 
              linewidth = 0.5, 
              aes(fill = ifelse(z == 1, palette_colors, "white"))) +
    scale_fill_identity() +  
    coord_equal(expand = FALSE) +
    scale_x_continuous(
      breaks = 1:ncol(x),
      labels = col_labels,
      position = "top"
    ) +
    scale_y_continuous(
      breaks = 1:nrow(x),
      labels = row_labels
    ) +
    theme(
      axis.text = element_text(size = rel(1)),
      axis.ticks = element_blank(),
      legend.position = "none",
      plot.title = element_text(hjust = 1)
    ) +
    labs(x = "", y = "") +
    rotate_x_text(angle = 90, hjust = 0, vjust = 0.5)
  
  p
}

increase_focus <- function(x, group = NULL) {
  mcp <- apply(
    x, 
    MARGIN = 1, 
    FUN = \(z) { mean(which(z == 1)) }, 
    simplify = FALSE
  ) |> unlist()
  row_order <- order(mcp, na.last = TRUE)
  x <- x[row_order, ]
  
  if (!is.null(group)) {
    group <- group[row_order]
  }
  
  mrp <- apply(
    x, 
    MARGIN = 2, 
    FUN = \(z) { mean(which(z == 1)) }, 
    simplify = FALSE
  ) |> unlist()
  x <- x[, order(mrp, na.last = TRUE)]
  
  list(matrix = x, group = group)
}

concentrate <- function(x, group = NULL, max_iter = 100) {
  old <- x
  not_identical <- TRUE
  iter <- 0
  
  while (not_identical && iter < max_iter) {
    result <- increase_focus(old, group)
    new <- result$matrix
    group <- result$group
    not_identical <- !identical(old, new)
    old <- new
    iter <- iter + 1
  }
  
  if (iter == max_iter) {
    warning("Reached maximum iterations without convergence.")
  }
  
  list(matrix = new, group = group)
}

produce_clusters <- function(artifact_data, artifact_data_unique, method = "seriation", color_palette = c("#8DD3C7", "#FFFFB3")){
  
  artifact_data <- artifact_data %>% 
    select_if(~ !is.numeric(.) || sum(.) != 0) %>% 
    mutate_all(~ as.numeric(. > 0))
  
  jac <- vegdist(artifact_data, "jaccard", binary = TRUE)
  dm <- as.matrix(jac)
  
  if(method == "seriation"){
  artifact_matrix <- as.matrix(artifact_data)
  rownames(artifact_matrix) <- rownames(artifact_data)

  group <- artifact_data_unique$group
  unique_group <- unique(group)
 # color_palette <-  RColorBrewer::brewer.pal(length(unique_group), "Set3")
  row_colors <- setNames(color_palette, unique_group)
  result <- concentrate(artifact_matrix, group = group)
  concentrated_matrix <- result$matrix
  reordered_group <- result$group
  group_colors <- row_colors[reordered_group]

  final_plot <- mplot(concentrated_matrix,
    palette_colors = group_colors)
  }
  
  if(method == "network"){
  disim <- 1 - dm
  disim[disim<0.2] <- 0
  disim_net <- network(disim,
                       directed=F,
                       ignore.eval=F,
                       names.eval='weight')
  disim_net %v% 'vertex.names' <- row.names(artifact_data)
  set.seed(500)
  
  final_plot <- ggraph(disim_net, layout="fr") +
      geom_edge_link(aes(width = weight, 
                         alpha=weight), 
                     edge_colour = "black", 
                     show.legend= F,
                    ) +
      scale_edge_width(range=c(0.5,1.5)) +
      scale_edge_colour_gradient(low = "#CCCCCC",
                                 high = "#000000") +
      geom_node_point(alpha=1, size=5) +
      geom_node_text(aes(label=row.names(artifact_data)), 
                     size=3, 
                     family= "Arial", 
                     repel=T, max.overlaps = 100) +
      theme(text= element_text(size = 15), 
            panel.background = element_rect(fill = 'white')) +
    border(color = "black", size = 0.5)
    
  }
  return(final_plot)
}

strength_function <- function(artifact_data, group_data){
  
  set.seed(500)
  jac <- vegdist(artifact_data %>% mutate_all(~ as.numeric(. > 0)), "jaccard", binary = TRUE)
  dm <- as.matrix(jac)
  modul_matrix <-
    graph_from_adjacency_matrix(1 - dm, mode = "undirected")
  mem <- as_membership(parse_number(group_data$group))
  as_group <- modularity(modul_matrix, membership = mem)
  
  perman <- adonis2(jac~as.factor(group_data$group), 
                    method = "jaccard",
                    sqrt.dist = TRUE)
  perman <- perman %>% 
    data_frame() %>% 
    slice_head()
  perman_r <- perman$R2
  perman_p <- perman$`Pr(>F)`
  
  site_distances <- dist(cbind(group_data$longitude, group_data$latitude))
  mantel_distance <- vegan::mantel(site_distances, jac, permutations = 1000)
  p_value_distance_correlation <- round(mantel_distance$signif, 3)
  r_value_distance_correlation <- round(mantel_distance$statistic, 3)
  
  final_table <- data_frame("Modularity" = as_group, 
                            "PerMANOVA r" = perman_r,
                            "PerMANOVA p" = perman_p,
                            "Mantel R" = r_value_distance_correlation, 
                            "Mantel p" = p_value_distance_correlation)

  return(final_table)
}


trans_network <- function(artifact_data){
    jac <- vegdist(artifact_data %>%  mutate_all(~ as.numeric(. > 0)), "jaccard", binary = TRUE)
    dm <- as.matrix(jac)
    disim <- 1 - dm
    disim[disim<0.1] <- 0
    disim_net <- network(disim,
                         directed=F,
                         ignore.eval=F,
                         names.eval='weight')
    disim_net %v% 'vertex.names' <- row.names(artifact_data)
    set.seed(500)
    final_plot <- ggraph(disim_net, layout="fr") +
      geom_edge_link(aes(width = weight, 
                         alpha=weight), 
                       edge_colour = "black", 
                       show.legend=F) +
      scale_edge_width(range=c(0.5,1.5)) +
      scale_edge_colour_gradient(low = "#CCCCCC",
                                   high = "#000000") +
      geom_node_point(alpha=1, size=5) +
      geom_node_text(aes(label=row.names(artifact_data)), 
                     size=3, 
                     family= "Arial", 
                     repel=T, max.overlaps = 100) +
      theme(text= element_text(size = 15), 
            panel.background = element_rect(fill = 'white')) +
      border(color = "black", size = 0.5)
    return(final_plot)
    }
```

```{r fig.height= 9, fig.width= 13}
#| label: fig-seriation
#| fig-cap: "Seriation analysis of the data"

seriation_trans <- 
  produce_clusters(trans_artifact_data, 
                   trans_unique_data, 
                   method = "seriation")

seriation_proto <- 
  produce_clusters(proto_artifact_data, 
                   proto_unique_data, 
                   # BM: not sure why this one gets the 
                   # colour differently from the others
                   color_palette = c("#FFFFB3", "#8DD3C7"),
                   method = "seriation")

seriation_early <- 
  produce_clusters(early_artifact_data, 
                   early_unique_data, 
                   method = "seriation")

seriation_evolved <- 
  produce_clusters(evolved_artifact_data, 
                   evolved_unique_data, 
                   method = "seriation")

plot_grid(seriation_trans,
          seriation_proto, 
          seriation_early , 
          seriation_evolved, 
          ncol = 2, 
          align = "hv", 
          labels = c("Transitional", "Proto", "Early", "Evolved"), label_size = 15, 
          scale = c(1, 1, 1, 1))


```

For each of the phases, seriation identifies at least two groups, one with a restricted range of sign types, and one with a broader range. The notch and line signs are the most prevalent sign types across all time periods. In the Transitional phase, there is a small range of sign types. The restricted group consists of Fumane, Pod Hradem, and Geissenklösterle, two of which only have a notch, and one of which has a notch and circumnotch. The broader group consists of Labeko Koba, Hohle Fels, and El Castillo. In the Proto-Aurignacian we see an expansion in both the number of sites and range of signs, with no overlap in sites from the Transitional phase, except for Geissenklösterle, which is present in both phases. The restricted group consists of Abri Pataud, Gatzarria, Hohlenstein-Stadel, and Mladeč, three of which only have notches and lines, and one also has a dashline. The broader group consists of Geissenklösterle, Spy, Vogelherd, Grotte du Renne, La Ferrassie, and Les Cottés, where we see a more consistent pattern of a more diverse range of signs, compared to the broader group of the Transitional phase. In the Early Aurignacian, we see appearance of completely new sites with no overlap with the Proto-Aurignacian sites, as well as increased diversity of patterns within the groups. The restricted group consists of Grottes de Fonds-de-Forêt (radnotch and notch), Riparo Bombrini (notch), and Grotte de la Verpillière I (notch and line), The broader group consists of Solutré, Hohle Fels, Castanet, Cellier, Blanchard, and Trou al'Wesse, which contain a wide range of signs in a variety of combinations. Lastly, in the Evolved Aurignacian, we see slightly more consistent groups, again with new sites with no overlap with the Early Aurignacian sites, except for Hohle Fels, which also appears in the Transitional phase. Vogelherd also reappears, having appeared earlier in the Proto-Aurignacian.The restricted group consists of Les Rois, Gargas, La Viña, Sirgenstein Cave, and Vindija Cave, covering the line, notch, and and obline signs. The broader group consists of Trou Magrite, Bockstein-Törle, Vogelherd, and Hohle Fels. Overall, across the four phases, the number of sites in the restricted group tends to be less than or equal to the number of sites in the broader group, with the exception of the final Evolved phase. <!-- BM: I reckon we need to say something about the signs also, not just the sites -->

```{r fig.height= 5.5, fig.width= 8}
#| label: fig-neighbor-net
#| fig-cap: "Network analysis of the data"
network_trans <- trans_network(trans_artifact_data)
network_proto <- produce_clusters(proto_artifact_data, proto_unique_data, method = "network")
network_early <- produce_clusters(early_artifact_data, early_unique_data, method = "network")
network_evolved <- produce_clusters(evolved_artifact_data, evolved_unique_data, method = "network")

plot_grid(network_trans, network_proto, network_early, network_evolved, 
          ncol = 2, align = "hv", labels = c("Transitional", "Proto", "Early", "Evolved"), 
          label_size = 7, label_colour = "black", label_y = 1.02, label_x = -0.01)
```

The results of the network analysis supports the restricted-broad groupings identified in @fig-seriation, and provides additional insights into the evolution of connectivity between groups. In the Transitional phase, the network analysis reveals two distinct and disconnected groups. The restricted group consists of Geissenklösterle, Fumane, and Pod Hradem, and the broad group consisting of Hohle Fels, El Castillo, and Labeko Koba, with no connections between the groups. The Proto-Aurignacian phase also shows two clearly defined groups, the broad group consisting of Geissenklösterle, Spy, Vogelherd, and Grotte du Renne, and the restricted group consisting of Mladeč, Hohlenstein-Stadel, Gatzarria, and Abri Pataud. However, it also displays some connectivity between the two groups of sites, with La Ferrassie connected to both groups. Les Cottés stands out with no connections to either group. The Early Aurignacian shows more strongly inter-connected groups -- although the shape still suggests two main groups -- with Grotte de la Verpillière I in particular having multiple strong connections to both groups. Lastly, the Evolved Aurignacian again shows two main groups, although intra-group connectivity has decreased, with the broad group consisting of Hohle Fels, Trou Magrite, Vogelherd, and Bockstein-Törle, and the restricted group consisting of Gargas, La Viña, Sirgenstein Cave, Vindija Cave, and Les Rois. As for the Early Aurignacian,inter-connectivity between groups continues to be evident in the Evolved Aurignacian, with connections between Trou Magrite, Gargas, and Vindija Cave, and Bockstein-Törle and Gargas, however the strength of inter-connectivity is weaker than in the Early Aurignacian.

## Cultural Group Strength

```{r}
#| label: tbl-strength-table
#| tbl-cap: "Table of the results per phase for the modularity test and perMANOVA"
#| tbl-cap-location: bottom

## Modularity test
trans_strength <- strength_function(trans_artifact_data, trans_unique_data)
proto_strength <- strength_function(proto_artifact_data, proto_unique_data)
early_strength <- strength_function(early_artifact_data, early_unique_data)
evolved_strength <- strength_function(evolved_artifact_data, evolved_unique_data)

full_table <- rbind(trans_strength, proto_strength, early_strength, evolved_strength) %>% 
  mutate(`Aurignacian phase` = c("Transitional", 
                           "Proto-Aurignacian",
                           "Early Aurignacian", 
                           "Evolved Aurignacian"), 
         .before = 1)

strength_table <- full_table %>% 
  dplyr::select(`Aurignacian phase`, Modularity, `PerMANOVA r`, `PerMANOVA p`) %>% 
  mutate(across(where(is.numeric), ~ round(., 3)))

kable(strength_table)

proto_modularity <- proto_strength %>% 
  dplyr::select(Modularity)
evolved_modularity <- evolved_strength %>% 
  dplyr::select(Modularity)

trans_perm_r <- trans_strength %>% 
  dplyr::select(`PerMANOVA r`)
early_perm_r <- early_strength %>% 
  dplyr::select(`PerMANOVA r`)

trans_perm_p <- trans_strength %>% 
  dplyr::select(`PerMANOVA p`)
```

The modularity score quantifies the strength of the groupings, showing that the variations in grouping strength between phases are fairly minimal. The results tell us that the Proto-Aurignacian exhibits the strongest groupings, with a score of `r proto_modularity`, and that the Evolved Aurignacian exhibits the weakest groupings, with a score of `r evolved_modularity`. There is a slight increase in modularity between the Transitional period and the Proto-Aurignacian, before an even slighter decrease into the Early Aurignacian, followed by a larger decrease with the Evolved Aurignacian.

The R statistic from the perMANOVA tests tell us the proportion of sign variation that can be explained by group membership. The Transitional period has the highest score of `r trans_perm_r` while the Early Aurignacian has the lowest score of `r early_perm_r`. We see a large decline in scores between the Transitional and the Proto-Aurignacian periods, before a slight increase in between the Early and Evolved Aurignacian periods. The perMANOVA p score quantifies the statistical significance of the difference, with 0.05 as the threshold. The only time period to not meet that threshold is the Transitional period (p = `r trans_perm_p`). There is a slight increase between the Proto and Early Aurignacian, and a slightly large increase in the Evolved Aurignacian period, although they all still meets the threshold for statistical significance.

## Effect of Geographic Distance

```{r}
#| label: tbl-mantel-table
#| tbl-cap: "Table of the results per phase for the Mantel test between a Jaccard matrix of sign type diversity and a geographic distance matrix"
#| tbl-cap-location: bottom
## Mantel test for geography vs signs
mantel_table <- full_table %>% 
  dplyr::select(`Aurignacian phase`, `Mantel R`, `Mantel p`)

kable(mantel_table)

proto_mantel_r <- proto_strength %>% 
  dplyr::select(`Mantel R`)

proto_mantel_p <- proto_strength %>% 
  dplyr::select(`Mantel p`)

early_mantel_r <- early_strength %>% 
  dplyr::select(`Mantel R`)

early_mantel_p <- early_strength %>% 
  dplyr::select(`Mantel p`)

```

The relevance of the isolation-by-distance hypothesis also varies from period to period. The p score quantifies the correlation, with a score of 0.05 or lower meaning that there is a statistically significant relationship between sign type distribution and geographical distance. None of the periods meet that threshold, meaning that the isolation-by-distance hypothesis is not applicable to any of them. However, we still see changes in the p score between periods, suggesting a higher level of correlation with geographic distance in some, and a lower correlation in others. The Proto-Aurignacian period demonstrates the least amount of correlation (Mantel R = `r proto_mantel_r`, p = `r proto_mantel_p`), while the Early Aurignacian exhibits the highest amount of correlation (Mantel R = `r early_mantel_r`, p = `r early_mantel_p`).

<!-- BM: I reckon here might be the place to make some comments about geographic distribution of the groups and boundaries, and reference the map below --> 


```{r fig.height= 7, fig.width=10}
#| label: fig-group-map
#| fig-cap: "Map of sites faceted by time period and colored by group number"
  
ggplot(Europe) +
  geom_sf() +
  geom_sf(data = signbase_sf, aes(color = group)) +
  coord_sf(xlim = c(-10,30), 
           ylim = c(35,53), 
           expand = FALSE) +
  geom_text_repel(data = signbase_sf,
                  aes(x = longitude ,
                      y = latitude,
                      label = site_name),
                  max.overlaps = 30,
                  size = 2,
                  bg.color = "white",
                  bg.r = 0.25) +
  theme_minimal() +
  facet_wrap(~time_period) +
  theme(axis.text = element_blank(),
        axis.title = element_blank()) 

```

<<<<<<< HEAD

## Cultural Group Strength

```{r}
#| label: tbl-strength-table
#| tbl-cap: "Table of the results per phase for the modularity test and perMANOVA"
#| tbl-cap-location: bottom
##Modularity test
trans_strength <- strength_function(trans_artifact_data, trans_unique_data)
proto_strength <- strength_function(proto_artifact_data, proto_unique_data)
early_strength <- strength_function(early_artifact_data, early_unique_data)
evolved_strength <- strength_function(evolved_artifact_data, evolved_unique_data)

full_table <- rbind(trans_strength, proto_strength, early_strength, evolved_strength) %>% 
  mutate(`time period` = c("Transitional", "Proto-Aurignacian",
                                                       "Early Aurignacian", "Evolved Aurignacian"), .before = 1)

strength_table <- full_table %>% 
  dplyr::select(`time period`, modularity, `permanova r`, `permanova p`)

kable(strength_table)

proto_modularity <- proto_strength %>% 
  dplyr::select(modularity)
evolved_modularity <- evolved_strength %>% 
  dplyr::select(modularity)

trans_perm_r <- trans_strength %>% 
  dplyr::select(`permanova r`)
early_perm_r <- early_strength %>% 
  dplyr::select(`permanova r`)

trans_perm_p <- trans_strength %>% 
  dplyr::select(`permanova p`)
```

The modularity score quantifies the strength of the groupings, showing that the variations in grouping strength between phases are fairly minimal. The results tell us that the Proto-Aurignacian exhibits the strongest groupings, with a score of `r proto_modularity`, and that the Evolved Aurignacian exhibits the weakest groupings, with a score of `r evolved_modularity`. There is a slight increase in modularity between the Transitional period and the Proto-Aurignacian, before an even slighter decrease into the Early Aurignacian, followed by a larger decrease with the Evolved Aurignacian.

The R statistic from the perMANOVA tests tell us the proportion of sign variation that can be explained by group membership. The Transitional period has the highest score of `r trans_perm_r` while the Early Aurignacian has the lowest score of `r early_perm_r`. We see a large decline in scores between the Transitional and the Proto-Aurignacian periods, before a slight increase in between the Early and Evolved Aurignacian periods. The perMANOVA p score quantifies the statistical significance of the difference, with 0.05 as the threshold. The only time period to not meet that threshold is the Transitional period (p = `r trans_perm_p`). There is a slight increase between the Proto and Early Aurignacian, and a slightly large increase in the Evolved Aurignacian period, although they all still meets the threshold for statistical significance.

## Effect of Geographic Distance

```{r}
#| label: tbl-mantel-table
#| tbl-cap: "Table of the results per phase for the Mantel test between a Jaccard matrix of sign type diversity and a geographic distance matrix"
#| tbl-cap-location: bottom
## Mantel test for geography vs signs
mantel_table <- full_table %>% 
  dplyr::select(`time period`, `mantel r`, `mantel p`)

kable(mantel_table)

proto_mantel_r <- proto_strength %>% 
  dplyr::select(`mantel r`)

proto_mantel_p <- proto_strength %>% 
  dplyr::select(`mantel p`)


early_mantel_r <- early_strength %>% 
  dplyr::select(`mantel r`)


early_mantel_p <- early_strength %>% 
  dplyr::select(`mantel p`)


```

The relevance of the isolation-by-distance hypothesis also varies from period to period. The p score quantifies the correlation, with a score of 0.05 or lower meaning that there is a statistically significant relationship between sign type distribution and geographical distance. None of the periods meet that threshold, meaning that the isolation-by-distance hypothesis is not applicable to any of them. However, we still see changes in the p score between periods, suggesting a higher level of correlation with geographic distance in some, and a lower correlation in others. The Proto-Aurignacian period demonstrates the least amount of correlation (Mantel R = `r proto_mantel_r`, p = `r proto_mantel_p`), while the Early Aurignacian exhibits the highest amount of correlation (Mantel R = `r early_mantel_r`, p = `r early_mantel_p`).
=======
>>>>>>> b5934f5bc3a2913f88470ea0c9a1d2211b4f23e3

# Discussion

The first aim of our study was to determine how the grouping dynamics of geometric signs changed across the four phases of the Aurignacian, specifically in terms of diversity, size, connectivity, and boundaries. The results as displayed in @fig-seriation show that each phase can be divided into two main cultural groups, with diversity serving as a major dividing factor, and that group size varied from phase to phase, with a large increase in between the Transitional phase and the Proto-Aurignacian.


@fig-neighbor-net shows that group inter-connectivity and intra-connectivity varies from phase to phase, with weak inner group connections and no between-group connections in the Transitional phase, to stronger intraconnections and interconnections starting to form in the Proto-Aurignacian, to extremely strong connections (both between and within groups) in the Early Aurignacian, to weaker connections in the Evolved Aurignacian. The modularity tests, as shown in @tbl-strength-table, show that the groupings are strongest in the Transitional period and weakest in the Early Aurignacian, and the perMANOVA tests tell us that the Transitional period experiences the highest level of difference between groups, while the Early Aurignacian experiences the least. The Mantel tests, as shown in @tbl-mantel-table, tell us that the sign distribution in the Proto-Aurignacian experiences the lowest correlation with geographic distance, while the Early Aurignacian experiences the highest correlation.

Map shows that geographic boundaries do not readily correspond to the group distributions and Mantel test results





The second aim of our study was to determine what these patterns tell us about dynamics of social organization throughout the Aurignacian. The results suggest that the Transitional phase was sparsely populated, with minimal interaction between loosely connected groups. For the Proto-Aurignacian, the results suggest a large expansion in social activity, as well as strongly inner-connected groups with some inter-connectivity present, with geographic distance having the least influence on sign distribution. The Early Aurignacian experiences a large surge in inter-connectivity, as well as inner-connectivity strength, with a great deal of connection between groups and an increase in the correlation with geographic distance. The Evolved Aurignacian experiences a decline in connection strength, although it maintains degrees of inter-connectivity.

These results are supported by the existing data on the environmental and biological change established during these phases. @Shao_Wegener_Klein_Schmidt_Weniger_2024 tells us that from 45 - 43.25 k BP, the population density in Europe was extremely low, due to the unfavorable environmental conditions of Greenland Stadial 12 (44 k BP) and the slow westward expansion of early modern humans, before being followed by rapid expansion from 43.25 - 41 k BP, with the maximum extent of Proto/Early Aurignacian (Aur-P1) settlement being reached around 41 k BP. This rapid expansion could be what stimulated the emergence of sign sue as a marker of group membership.



Additionally @Banks_dErrico_Zilhao_2013 use eco-cultural niche modeling to show that the Heinrich Stadial 4 at the very beginning of the Early Aurignacian resulted in an expansion into new environmental niches, which they hypothesize was associated with expansion of social networks both within and between populations. This likely explains why we see a large increase in both inter-connectivity and inner-connectivity strength in the Early Aurignacian, as well as the increased correlation with geographic distance. Lastly, @Shao_Limberg_Klein_Wegener_Schmidt_Weniger_Hense_Rostami_2021 developed a human-existence probability model for the Aurignacian, finding an expanded, more dispersed settlement area for Evolved/Late Aurignacian (Aur-P2) theorizing that the environmental changes of HS4 lead to humans better adapted to survive in a broader range of climate conditions. @Shao_Wegener_Klein_Schmidt_Weniger_2024 also find an increase in expansion marking the beginning of the Evolved Aurignacian. Geographic expansion resulting in less group interconnection could explain why we see weaker connections in the Evolved Aurignacian.

# Conclusion

The observed social dynamics of the phases of the Aurignacian technocomplex correspond with the existing data on the environmental and social conditions of the Upper Paleolithic. This tells us that the usage of artwork as a proxy for cultural difference is an effective method for understanding the social dynamics of prehistoric humans.

# References
