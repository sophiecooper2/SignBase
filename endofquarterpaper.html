<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sophie Cooper">

<title>Geometric Signs on Paleolithic Mobile Objects as Cultural Group Markers</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="endofquarterpaper_files/libs/clipboard/clipboard.min.js"></script>
<script src="endofquarterpaper_files/libs/quarto-html/quarto.js"></script>
<script src="endofquarterpaper_files/libs/quarto-html/popper.min.js"></script>
<script src="endofquarterpaper_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="endofquarterpaper_files/libs/quarto-html/anchor.min.js"></script>
<link href="endofquarterpaper_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="endofquarterpaper_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="endofquarterpaper_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="endofquarterpaper_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="endofquarterpaper_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Geometric Signs on Paleolithic Mobile Objects as Cultural Group Markers</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sophie Cooper </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>A distinctive quality of the Upper Paleolithic is the large rise in artwork, both parietal and mobile. Archaeologists have frequently relied upon that artwork as a proxy for cultural difference in order to understand the grouping patterns of early modern humans <span class="citation" data-cites="McDonald_Harper_2016 Pereira_Manen_2023 Fuentes_Lucas_Robert_2019">(<a href="#ref-McDonald_Harper_2016" role="doc-biblioref">McDonald and Harper 2016</a>; <a href="#ref-Pereira_Manen_2023" role="doc-biblioref">Pereira and Manen 2023</a>; <a href="#ref-Fuentes_Lucas_Robert_2019" role="doc-biblioref">Fuentes, Lucas, and Robert 2019</a>)</span>. During this period, we also see a rise in organized settlements, more complex social organizations, and more advanced tool-making across Europe <span class="citation" data-cites="Boyd_Silk_2020">(<a href="#ref-Boyd_Silk_2020" role="doc-biblioref">Boyd and Silk 2020</a>)</span>. Considered to be the starting point of the Upper Paleolithic, the Aurignacian period (ca. 43,000 - 30,000 years BP) is commonly linked to the dispersal of Homo sapiens across Western Eurasia, and is characterized by certain lithic and osseus markers <span class="citation" data-cites="Tejero_Grimaldi_2015 Tartar_2012">(<a href="#ref-Tejero_Grimaldi_2015" role="doc-biblioref">Tejero and Grimaldi 2015</a>; <a href="#ref-Tartar_2012" role="doc-biblioref">Tartar 2012</a>)</span>, many of which are decorated with geometric signs <span class="citation" data-cites="dutkiewicz2020">(<a href="#ref-dutkiewicz2020" role="doc-biblioref">Dutkiewicz et al. 2020</a>)</span>.</p>
<p>In this paper, we analyze the distribution and variation of geometric sign types found on mobile artefacts from the Upper Paleolithic in Europe during the Aurignacian period. The basis of this analysis is the idea that variations in signs can serve as an indicator of group membership and cultural similarity. This approach is supported by ethnographic and historical evidence <span class="citation" data-cites="texier2010howiesons Hodder1979 Hodder1977 Vanhaeren_2005">(<a href="#ref-texier2010howiesons" role="doc-biblioref">Texier et al. 2010</a>; <a href="#ref-Hodder1979" role="doc-biblioref">Hodder 1979</a>, <a href="#ref-Hodder1977" role="doc-biblioref">1977</a>; <a href="#ref-Vanhaeren_2005" role="doc-biblioref">Vanhaeren 2005</a>)</span> as well as similar archaeological studies of ornamental and parietal art <span class="citation" data-cites="Pereira_Manen_2023 Sauvet_2018 Rigaud_dErrico_Vanhaeren_2015 baker2024evidence Lycett_2019 Vanhaeren_d McDonald_Harper_2016">(<a href="#ref-Pereira_Manen_2023" role="doc-biblioref">Pereira and Manen 2023</a>; <a href="#ref-Sauvet_2018" role="doc-biblioref">Sauvet et al. 2018</a>; <a href="#ref-Rigaud_dErrico_Vanhaeren_2015" role="doc-biblioref">Rigaud, d’Errico, and Vanhaeren 2015</a>; <a href="#ref-baker2024evidence" role="doc-biblioref">Baker et al. 2024</a>; <a href="#ref-Lycett_2019" role="doc-biblioref">Lycett 2019</a>; <a href="#ref-Vanhaeren_d" role="doc-biblioref">Vanhaeren and d’Errico 2006</a>; <a href="#ref-McDonald_Harper_2016" role="doc-biblioref">McDonald and Harper 2016</a>)</span>. In this study, we address the following questions: Are cultural groups evident in the distribution of portable geometric signs, and if so, what can they tell us about the cultural diversity and movement of Upper Paleolithic humans?</p>
</section>
<section id="background" class="level1">
<h1>Background</h1>
<p>The purpose of this study is to contribute to our understanding of the patterns of cultural and genetic diversity among the early modern humans of the Upper Paleolithic. Previous works have performed cluster analysis methods upon variations in artefacts to represent and understand patterns of groups and cultural diversity, and have primarily relied upon personal ornamentation and parietal art, with few taking mobile objects into account. For example, multivariate analyses of Gravettian beads suggests an east to west cline of nine cultural groups <span class="citation" data-cites="baker2024evidence">(<a href="#ref-baker2024evidence" role="doc-biblioref">Baker et al. 2024</a>)</span>. The data set consisted of 134 discrete beads types from both burial and occupation sites, as distinguished by shape and material. Seriation analysis, PCoA, and network analysis were used to identify the groups. The geographically discrete clusters identified encompassed the regions of eastern, northwestern and central Europe, the northern and southern Iberian peninsula, southern and northern Italy, and the eastern and Western Mediterranean regions. The isolation-by-distance hypothesis, which proposes that cultural difference can be primarily explained by geographic distance, is tested using a Mantel test, determining that geographic distance cannot solely account for the bead distribution.</p>
<p>Similar analyses (seriation, correspondence and GIS) were also performed upon personal ornament types from the Aurignacian period as a proxy for linguistic diversity. The data set consisted of 157 distinct ornament types, and the analyses identified fourteen geographically cohesive clusters sharing similar ornament type associations <span class="citation" data-cites="Vanhaeren_d">(<a href="#ref-Vanhaeren_d" role="doc-biblioref">Vanhaeren and d’Errico 2006</a>)</span>. The clusters identified are geographically discrete and sweep counter-clockwise throughout western France, northern Spain, the Pyrenees, and the Mediterranean region. Availability of raw materials was considered ~in regards to~ the potential explanation that observed patterns are determined by <sub>such</sub>. ~It was concluded that, due to observed patterns in the data that countered that explanation~, [BM: They found that] the differences in personal ornamentation could not be explained by material availability.</p>
<p>Following the established precedent of using ornamentation and signs to identify cultural groups, we look to see if designs on mobile objects can be applicable here, and what it can add to the research being done. The additional dimension of mobility in this study allows us to potentially identify more geographically dispersed cultural groups, which might help visualize the migration patterns of early modern humans. Previous studies have primarily excluded mobile objects, and tend to find more geographically compact cultural groups as a result.</p>
<p>Our use of geometric signs in this study is supported by <span class="citation" data-cites="Sauvet_2018">Sauvet et al. (<a href="#ref-Sauvet_2018" role="doc-biblioref">2018</a>)</span>, in which used quadrilateral geometric parietal signs are used to identify Upper Paleolithic cultural groups in the Cantabrian region of Spain. The authors identified and classified the signs based on variations in form, then performed a factorial correspondence analysis and ascending hierarchical clustering upon the data in order to identify two clusters, which they argued represents distinct and separate groups of humans. In their study, <span class="citation" data-cites="Sauvet_2018">Sauvet et al. (<a href="#ref-Sauvet_2018" role="doc-biblioref">2018</a>)</span> made a case for the relevance of signs as identity markers, pointing to both the relevant qualities of signs, which are similar to those explained above, and the case studies throughout history where they served a similar purpose.</p>
<p>In this paper, we test the hypothesis that cultural groups are discernible in a big data set of geometric signs on mobile objects. Firstly, we identify clusters using seriation analysis, network analysis, and PCoA. We then test the strength of the clusters using modularity, perMANOVA, and PERMDISP2 tests. Lastly, we use mantel tests to evaluate the null hypothesis of isolation-by-distance.</p>
</section>
<section id="methods-and-materials" class="level1">
<h1>Methods and Materials</h1>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<div class="cell">
<div class="cell-output-display">
<div id="fig-site-map" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-site-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="endofquarterpaper_files/figure-html/fig-site-map-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-site-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Map of Palaeolithic sites containing signs, sign abundance is represented by point size, data from Dutkiewicz et al.&nbsp;(2020)
</figcaption>
</figure>
</div>
</div>
</div>
<p>Our data for this paper comes from SignBase, an open-access database collection of geometric signs on mobile objects from Paleolithic-era Europe, which was launched in 2020, with the explicit goal being to enable quantitative analyses of abstract geographical representation <span class="citation" data-cites="dutkiewicz2020">(<a href="#ref-dutkiewicz2020" role="doc-biblioref">Dutkiewicz et al. 2020</a>)</span>. The creators of the database identified around 30 distinct geometric sign types, and recorded their occurrences on mobile artefacts from the Paleolithic. Identification and categorization of the sign types had already been performed by the creators of the SignBase database, the methods for which are described in <span class="citation" data-cites="dutkiewicz2020">Dutkiewicz et al. (<a href="#ref-dutkiewicz2020" role="doc-biblioref">2020</a>)</span>, and we adhered to those categories and placements.</p>
<p>The data set consists of 531 artifacts found at 65 sites in 13 countries. The database records 55 geometric sign type found on these artifacts. We excluded signs if they fell under the “other” category, as the wide range of possibilities that could qualify as “other” means that it would be difficult to establish a definitive connection. We also excluded all data from Willendorf (only one sign present), and Riparo di Fontana Nuova, Muralovka, Shanidar Cave, and Hayonim Cave (due to their extreme geographic distance from the other sites). After those sites were excluded, all signs under the “rectangle” category were also removed as a side effect of that exclusion. Lastly, data from Grotte De La Princesse Pauline and Šandalja II was excluded, due to being dated much earlier than the rest of the artifacts.</p>
<p>These exclusions resulted in 511 artifacts found at 57 sites in 9 countries, encapsulating 54 sign types, as seen in <a href="#fig-site-map" class="quarto-xref">Figure&nbsp;1</a>. All our tests were run with presence/absence data, in order to keep the data from being affected by outliers like Vogelherd. We ran a Mantel test between an abundance distance matrix and and a Euclidean distance matrix in order to make sure that the exclusion of abundance would not significantly impact our results, and found that it was not statistically significant <span class="citation" data-cites="Lycett_2019">(<a href="#ref-Lycett_2019" role="doc-biblioref">Lycett 2019</a>)</span> (P = 0.208, Mantel R = 0.063)</p>
<p>The artifacts in question are determined to have been made in the Paleolithic era, specifically in the Aurignacien technocomplex. The calibrated radiocarbon dates of the artifacts range from approximately 32,893 BP to 44,778 BP, spanning an overall time range of 11,885 years. As seen in <a href="#fig-site-map" class="quarto-xref">Figure&nbsp;1</a>, the dates have a few outliers, but tend to cluster between 35000 - 42500 BP.</p>
</section>
<section id="testing-for-cultural-groupings" class="level2">
<h2 class="anchored" data-anchor-id="testing-for-cultural-groupings">Testing for Cultural Groupings</h2>
<p>Seriation analysis is the arrangement of data into a linear order to reveal patterns, and is a common technique in analyzing sets of archaeological data <span class="citation" data-cites="Hahsler_Hornik_Buchta">(<a href="#ref-Hahsler_Hornik_Buchta" role="doc-biblioref">Hahsler, Hornik, and Buchta 2008</a>)</span>. Seriation in this paper was performed using code designed to mimic the Browner-Kile seriation algorithm <span class="citation" data-cites="Brower_Kile_1988">(<a href="#ref-Brower_Kile_1988" role="doc-biblioref">Brower and Kile 1988</a>)</span>, in which the data is presented in a matrix diagram, and a unidimensional sequence is generated by reordering the rows and columns to group the presences along the diagonal. This is done so by calculating the mean row and column positions of presences, and arranging the rows and columns by respectively.</p>
<p>Network analysis represents the relationship between nodes <span class="citation" data-cites="Mills_2017">(<a href="#ref-Mills_2017" role="doc-biblioref">Mills 2017</a>)</span>. In this network analysis, each node is a site, and each edge is a measure of sign similarity, with the direct value represented by edge weight. The results were plotted with the Fruchterman-Reingold layout <span class="citation" data-cites="Fruchterman_Reingold_1991">(<a href="#ref-Fruchterman_Reingold_1991" role="doc-biblioref">Fruchterman and Reingold 1991</a>)</span>, a force-directed graph layout for uniform edge lengths.</p>
<p>Principal coordinate decomposition analysis (PCoA) analyzes the eigenvalue decomposition of the Jaccard matrix and arranges the sites by dissimilarity <span class="citation" data-cites="Legendre_Legendre_2012">(<a href="#ref-Legendre_Legendre_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. This provides a visual of sign similarity as visualized by spacing and arrangement. The PCoA in this paper is calibrated to be plotted on a scatterplot, as opposed to a biplot.</p>
</section>
<section id="testing-strength-of-cultural-groupings" class="level2">
<h2 class="anchored" data-anchor-id="testing-strength-of-cultural-groupings">Testing Strength of Cultural Groupings</h2>
<p>The modularity test quantifies the randomness of the groupings by measuring the fraction of the edges in the network that fall within groups, minus the expected value if the edges were placed at random <span class="citation" data-cites="Newman_2006">Newman and Girvan (<a href="#ref-Newman_Girvan_2004" role="doc-biblioref">2004</a>)</span>. The results are expressed in a score of 0 to 1, with 0 meaning no significant subgroups, and 1 meaning perfect groupings. The PerMANOVA test quantifies the level of variation between groups versus the level of variation within groups <span class="citation" data-cites="Anderson_2017">(<a href="#ref-Anderson_2017" role="doc-biblioref">Anderson 2017</a>)</span>, with the results expressed by an R-statistic, and a P-score.</p>
<p>PERMDISP is a multivariate extension of Levene’s test <span class="citation" data-cites="Anderson_2006">Anderson, Ellingsen, and McArdle (<a href="#ref-Anderson_Ellingsen_McArdle_2006" role="doc-biblioref">2006</a>)</span>, for the analysis of multivariate homogeneity of group dispersion. In this study, we perform the PERMDISP test upon the Jaccard matrix as a measure of compositional dissimilarity. We did so using the “betadisper” function from the RStudio package ‘vegan’, which mimics the PERMDISP2 procedure <span class="citation" data-cites="Vegan2001">(<a href="#ref-Vegan2001" role="doc-biblioref">Oksanen et al. 2001</a>)</span>. In this code, the non-euclidean distance matrix is reduced to principal coordinates to embed them within a Euclidean space. The results are used to produce a visual of the level of overlap between the groups in terms of sign content.</p>
</section>
<section id="testing-isolation-by-distance-hypothesis" class="level2">
<h2 class="anchored" data-anchor-id="testing-isolation-by-distance-hypothesis">Testing Isolation-by-Distance Hypothesis</h2>
<p>The isolation-by-distance framework proposes that cultural difference can be primarily explained by geographic distance. Assuming that this framework is true, we would hypothetically see patterns of cultural features of Upper Paleolithic early modern humans that are dispersed according to geography. Conversely, if geographic distance cannot account for the distribution of the sign types, we would have to assume that other factors are at play, namely, movement of groups or the creation of social networks.</p>
<p>Mantel tests are used here to determine whether there is a correlation between sign distribution and geography. The Mantel test is run between a geographic distance matrix and a Jaccard dissimilarity matrix. The test seeks to determine the level of correspondence between the matrices through permuational evaluation of the null distribution <span class="citation" data-cites="Mantel_Smouse">(<a href="#ref-Mantel_Smouse" role="doc-biblioref">Smouse and Long 1992</a>)</span>, producing a p-score as a result.</p>
</section>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<section id="testing-for-cultural-groupings-1" class="level2">
<h2 class="anchored" data-anchor-id="testing-for-cultural-groupings-1">Testing for Cultural Groupings</h2>
<div class="cell">
<div class="cell-output-display">
<div id="fig-seriation" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-seriation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="endofquarterpaper_files/figure-html/fig-seriation-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seriation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Seriation analysis of the data
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-neighbor-net" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-neighbor-net-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="endofquarterpaper_files/figure-html/fig-neighbor-net-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-neighbor-net-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Neighbor-Net analysis of the data
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-pcoa" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pcoa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="endofquarterpaper_files/figure-html/fig-pcoa-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pcoa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: PCoA analysis of the data
</figcaption>
</figure>
</div>
</div>
</div>
<p>Combining the results of the above tests allowed us to find 11 groups of sites, as shown in <a href="#fig-group-table" class="quarto-xref">Figure&nbsp;5</a>. The geographic distributions of the groups are shown in <a href="#fig-group-map" class="quarto-xref">Figure&nbsp;6</a>, and the sign makeup of each group is shown in <a href="#fig-group-sign" class="quarto-xref">Figure&nbsp;7</a>.</p>
</section>
<section id="groups" class="level2">
<h2 class="anchored" data-anchor-id="groups">Groups</h2>
<div class="cell">
<div id="fig-group-table" class="cell-output-display quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-group-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 95%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Group</th>
<th style="text-align: left;">Site Names</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Abri Pataud, El Rascaño, Fumane, La Viña, Lhotka, Pod Hradem, Riparo Bombrini, Sirgenstein Cave, Šandalja II</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Kvasice, Labeko Koba, Les Rois, Slatinice, Göpfelsteinhöhle</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Aurignac, d’Engihoul, Istállóskő Cave, Hohlenstein-Stadel, Gargas, Grotte de la Verpillière I, Mladeč, Brassempouy, Gatzarria</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Wildscheuer, Breitenbach, Peskő Cave, Vindija Cave, El Castillo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">Tuto de Camalhot, Abri Lartet/Gorge d’Enfer, Castanet, Le Trou Du Renard, Grottes de Fonds-de-Forêt</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">Nová Dědina, Menton/Grottes du Grimaldi, Grotte du Renne, Solutré, Žlutava, Spy</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">Trou Magrite, Grotte De La Princesse Pauline, Grotte de Goyet, Bockstein-Törle</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">Trou al’Wesse, Maisières-Canal, Les Cottés, Le Terme Pialat</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">Vogelherd, Hohle Fels, Geissenklösterle</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">Cellier, Blanchard, La Ferrassie, Hornos de la Pena, Otaslavice</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: left;">La Souquette, Shelter Birów IV, Abri de Laussel, Abri du Poisson</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-group-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Table of the sites by group
</figcaption>
</figure>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-group-map" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-group-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="endofquarterpaper_files/figure-html/fig-group-map-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-group-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Map of sites faceted and colored by group number
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-group-sign" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-group-sign-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="endofquarterpaper_files/figure-html/fig-group-sign-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-group-sign-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Bar plot of signs by group
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="testing-strength-of-cultural-groupings-1" class="level2">
<h2 class="anchored" data-anchor-id="testing-strength-of-cultural-groupings-1">Testing Strength of Cultural Groupings</h2>
<p>The modularity test, when run on the above groupings, resulted in a score of 0.8122771. The perMANOVA test produced an R-squared value of 0.5705284 and a P value of 0.001, which tells us that the groupings are statisically significant, and that 52% of the variability in the sign distribution can be attributed to group membership. The multivariate homogeneity test of group dispersions produced <a href="#fig-perm-disp" class="quarto-xref">Figure&nbsp;8</a>, showing that the overlap between groups is fairly minimal.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-perm-disp" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-perm-disp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="endofquarterpaper_files/figure-html/fig-perm-disp-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-perm-disp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Multivariate homogeneity of group dispersions
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="testing-isolation-by-distance-hypothesis-1" class="level2">
<h2 class="anchored" data-anchor-id="testing-isolation-by-distance-hypothesis-1">Testing Isolation-by-Distance Hypothesis</h2>
<div class="cell">
<div class="cell-output-display">
<div id="fig-distance-mantel" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distance-mantel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="endofquarterpaper_files/figure-html/fig-distance-mantel-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distance-mantel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Mantel correlogram showing the results of a mantel test run between a geographic distance matrix and a dissimilarity matrix for site sign types
</figcaption>
</figure>
</div>
</div>
</div>
<p>In terms of geographic correlation, there is no significant statistical correlation between the geographic distance matrix and the sign type dissimilarity matrix (P = 0.536, Mantel R = -0.011). Again, the results are displayed in a mantel correlogram (<a href="#fig-distance-mantel" class="quarto-xref">Figure&nbsp;9</a>), which demonstrates that similarity and geographic distance do not experience a clearly correlated relationship.</p>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>In this paper, we set out to ask if identifiable and relevant patterns existed in the data, and if so, what could they tell us about the patterns of diversity and movement among Upper Paleolithic humans?</p>
<p>Through our various analyses, we saw that the isolation-by-distance framework could not account for the distribution of sign types. Specifically, our Mantel test (<a href="#fig-distance-mantel" class="quarto-xref">Figure&nbsp;9</a>) found no statistically significant relationship between geographic distance and sign variation. Therefore, we must look to other factors to explain the distribution. We also saw distinct groupings in the data, as demonstrated in <a href="#fig-seriation" class="quarto-xref">Figure&nbsp;2</a>, <a href="#fig-neighbor-net" class="quarto-xref">Figure&nbsp;3</a>, and <a href="#fig-pcoa" class="quarto-xref">Figure&nbsp;4</a>. We divided the sites into approximately ten groups based on sign types with a modularity score of 0.8122771. <a href="#fig-group-map" class="quarto-xref">Figure&nbsp;6</a> shows groups with sites both clustered geographically speaking, and more distant from each other, potentially showing us cultural groups and patterns of movement.</p>
<p>One explanation for the sign type distribution could be that the groupings of the data represent cultural groups, as indicated by sign type patterns, and the geographic distribution between sites represent group mobility. <span class="citation" data-cites="Whallon_2006">Whallon (<a href="#ref-Whallon_2006" role="doc-biblioref">2006</a>)</span> proposes a framework for understanding hunter-gatherer mobility, arguing that mobility occurs among hunter-gatherers for multiple reasons. The first two reasons, referred to by Whallon as logistical and residential mobility, occur when groups move in order to procure a new supply of resources once the more immediate ones have been depleted. Another type of mobility is network mobility, in which groups, or subsets of groups, move in order to make contact with other groups. This occurs in order to form a “safety net”, in times of scarce resources, so that groups are assured of a positive reception if they are forced to move. Lastly, and similarly, is informational mobility, in which groups, or individuals, move with the primary goal of gathering information, typically about the environmental conditions and resources in other areas. Similarly, this operates as a “safety net” of sorts, in that these groups then posses knowledge on where to move in times of resource scarcity. One point of note is that, according to <span class="citation" data-cites="Whallon_2006">Whallon (<a href="#ref-Whallon_2006" role="doc-biblioref">2006</a>)</span>, decorative objects may be exchanged as a method of network formation, which may account for the presence of some signs at some sites.</p>
<p>Further research will need to be done on this topic in order to understand these patterns. In particular, the ecological and biogeographical conditions at the sites will need to be analyzed for potential connections, as mobility is heavily environmentally-motivated. Additionally, further analysis of the sign type categories as created by <span class="citation" data-cites="dutkiewicz2020">Dutkiewicz et al. (<a href="#ref-dutkiewicz2020" role="doc-biblioref">2020</a>)</span>, as it is possible, when it comes to the simpler signs, for identical creation to occur independently.</p>
<p>However, this preliminary research has been able to produce some conclusions to be reasonably confident in. Firstly, given that we know definitively that distribution and variation of sign types is not the result of geographic distance, we can conclude that the data is likely relevant to understanding patterns of cultural diversity. Secondly, we have found clusters of sites that correspond in sign type, possibly indicating mobility of specific cultural groups. These conclusions contribute to, and broaden our current understanding of cultural and biological diversity among Upper Paleolithic Homo sapiens in Europe.</p>
</section>
<section id="conclusion" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Conclusion</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Anderson_2006" class="csl-entry" role="listitem">
Anderson, Marti J. 2006. <span>“Distance-Based Tests for Homogeneity of Multivariate Dispersions.”</span> <em>Biometrics</em> 62 (1): 245–53. <a href="https://doi.org/10.1111/j.1541-0420.2005.00440.x">https://doi.org/10.1111/j.1541-0420.2005.00440.x</a>.
</div>
<div id="ref-Anderson_2017" class="csl-entry" role="listitem">
———. 2017. <span>“Permutational Multivariate Analysis of Variance (PERMANOVA).”</span> In <em>Wiley StatsRef: Statistics Reference Online</em>, 1–15. John Wiley &amp; Sons, Ltd. <a href="https://doi.org/10.1002/9781118445112.stat07841">https://doi.org/10.1002/9781118445112.stat07841</a>.
</div>
<div id="ref-Anderson_Ellingsen_McArdle_2006" class="csl-entry" role="listitem">
Anderson, Marti J., Kari E. Ellingsen, and Brian H. McArdle. 2006. <span>“Multivariate Dispersion as a Measure of Beta Diversity.”</span> <em>Ecology Letters</em> 9 (6): 683–93. <a href="https://doi.org/10.1111/j.1461-0248.2006.00926.x">https://doi.org/10.1111/j.1461-0248.2006.00926.x</a>.
</div>
<div id="ref-baker2024evidence" class="csl-entry" role="listitem">
Baker, Jack, Solange Rigaud, Daniel Pereira, Lloyd A Courtenay, and Francesco d’Errico. 2024. <span>“Evidence from Personal Ornaments Suggest Nine Distinct Cultural Groups Between 34,000 and 24,000 Years Ago in Europe.”</span> <em>Nature Human Behaviour</em> 8 (3): 431–44.
</div>
<div id="ref-Boyd_Silk_2020" class="csl-entry" role="listitem">
Boyd, R., and J. B. Silk. 2020. <em>How Humans Evolved</em>. W.W. Norton. <a href="https://books.google.com/books?id=XmrazQEACAAJ">https://books.google.com/books?id=XmrazQEACAAJ</a>.
</div>
<div id="ref-Brower_Kile_1988" class="csl-entry" role="listitem">
Brower, James C., and Kenneth M. Kile. 1988. <span>“Seriation of an Original Data Matrix as Applied to Paleoecology.”</span> <em>Lethaia</em> 21 (1): 79–93. <a href="https://doi.org/10.1111/j.1502-3931.1988.tb01756.x">https://doi.org/10.1111/j.1502-3931.1988.tb01756.x</a>.
</div>
<div id="ref-dutkiewicz2020" class="csl-entry" role="listitem">
Dutkiewicz, Ewa, Gabriele Russo, Saetbyul Lee, and Christian Bentz. 2020. <span>“SignBase, a Collection of Geometric Signs on Mobile Objects in the Paleolithic.”</span> <em>Scientific Data</em> 7 (1): 364. <a href="https://doi.org/10.1038/s41597-020-00704-x">https://doi.org/10.1038/s41597-020-00704-x</a>.
</div>
<div id="ref-Fruchterman_Reingold_1991" class="csl-entry" role="listitem">
Fruchterman, Thomas M. J., and Edward M. Reingold. 1991. <span>“Graph Drawing by Force-Directed Placement.”</span> <em>Software: Practice and Experience</em> 21 (11): 1129–64. <a href="https://doi.org/10.1002/spe.4380211102">https://doi.org/10.1002/spe.4380211102</a>.
</div>
<div id="ref-Fuentes_Lucas_Robert_2019" class="csl-entry" role="listitem">
Fuentes, Oscar, Claire Lucas, and Eric Robert. 2019. <span>“An Approach to Palaeolithic Networks: The Question of Symbolic Territories and Their Interpretation Through Magdalenian Art.”</span> <em>Quaternary International</em>, Symbolic territories prehistory, 503 (February): 233–47. <a href="https://doi.org/10.1016/j.quaint.2017.12.017">https://doi.org/10.1016/j.quaint.2017.12.017</a>.
</div>
<div id="ref-Hahsler_Hornik_Buchta" class="csl-entry" role="listitem">
Hahsler, Michael, Kurt Hornik, and Christian Buchta. 2008. <span>“Getting Things in Order: An Introduction to the r Package Seriation.”</span> <em>Journal of Statistical Software</em> 25 (3): 1–34. <a href="https://doi.org/10.18637/jss.v025.i03">https://doi.org/10.18637/jss.v025.i03</a>.
</div>
<div id="ref-Hodder1977" class="csl-entry" role="listitem">
Hodder, Ian. 1977. <span>“The Distribution of Material Culture Items in the Baringo District, Western Kenya.”</span> <em>Man</em> 12 (2): 239–69. <a href="http://www.jstor.org/stable/2800797">http://www.jstor.org/stable/2800797</a>.
</div>
<div id="ref-Hodder1979" class="csl-entry" role="listitem">
———. 1979. <span>“Economic and Social Stress and Material Culture Patterning.”</span> <em>American Antiquity</em> 44 (3): 446–54. <a href="http://www.jstor.org/stable/279544">http://www.jstor.org/stable/279544</a>.
</div>
<div id="ref-Legendre_Legendre_2012" class="csl-entry" role="listitem">
Legendre, P., and Louis Legendre. 2012. <em>Numerical Ecology</em>. Chantilly, NETHERLANDS, THE: Elsevier. <a href="http://ebookcentral.proquest.com/lib/washington/detail.action?docID=982554">http://ebookcentral.proquest.com/lib/washington/detail.action?docID=982554</a>.
</div>
<div id="ref-Lycett_2019" class="csl-entry" role="listitem">
Lycett, Stephen J. 2019. <span>“Confirmation of the Role of Geographic Isolation by Distance in Among-Tribe Variations in Beadwork Designs and Manufacture on the High Plains.”</span> <em>Archaeological and Anthropological Sciences</em> 11 (6): 2837–47. <a href="https://doi.org/10.1007/s12520-018-0742-3">https://doi.org/10.1007/s12520-018-0742-3</a>.
</div>
<div id="ref-McDonald_Harper_2016" class="csl-entry" role="listitem">
McDonald, Jo, and Sam Harper. 2016. <span>“Identity Signalling in Shields: How Coastal Hunter-Gatherers Use Rock Art and Material Culture in Arid and Temperate Australia.”</span> <em>Australian Archaeology</em> 82 (2): 123–38. <a href="https://doi.org/10.1080/03122417.2016.1186345">https://doi.org/10.1080/03122417.2016.1186345</a>.
</div>
<div id="ref-Mills_2017" class="csl-entry" role="listitem">
Mills, Barbara J. 2017. <span>“Social Network Analysis in Archaeology.”</span> <em>Annual Review of Anthropology</em> 46 (Volume 46, 2017): 379–97. <a href="https://doi.org/10.1146/annurev-anthro-102116-041423">https://doi.org/10.1146/annurev-anthro-102116-041423</a>.
</div>
<div id="ref-Newman_2006" class="csl-entry" role="listitem">
Newman, M. E. J. 2006. <span>“Modularity and Community Structure in Networks.”</span> <em>Proceedings of the National Academy of Sciences</em> 103 (23): 8577–82. <a href="https://doi.org/10.1073/pnas.0601602103">https://doi.org/10.1073/pnas.0601602103</a>.
</div>
<div id="ref-Newman_Girvan_2004" class="csl-entry" role="listitem">
Newman, M. E. J., and M. Girvan. 2004. <span>“Finding and Evaluating Community Structure in Networks.”</span> <em>Physical Review E</em> 69 (2): 026113. <a href="https://doi.org/10.1103/PhysRevE.69.026113">https://doi.org/10.1103/PhysRevE.69.026113</a>.
</div>
<div id="ref-Vegan2001" class="csl-entry" role="listitem">
Oksanen, Jari, Gavin L. Simpson, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R. B. O’Hara, et al. 2001. <span>“Vegan: Community Ecology Package.”</span> <a href="https://doi.org/10.32614/CRAN.package.vegan">https://doi.org/10.32614/CRAN.package.vegan</a>.
</div>
<div id="ref-Pereira_Manen_2023" class="csl-entry" role="listitem">
Pereira, Daniel, and Claire Manen. 2023. <span>“The Shaping of Social and Symbolic Capital During the Transition to Farming in the Western Mediterranean: Archaeological Network Analyses of Pottery Decorations and Personal Ornaments.”</span> <em>PLOS ONE</em> 18 (11): e0294111. <a href="https://doi.org/10.1371/journal.pone.0294111">https://doi.org/10.1371/journal.pone.0294111</a>.
</div>
<div id="ref-Rigaud_dErrico_Vanhaeren_2015" class="csl-entry" role="listitem">
Rigaud, Solange, Francesco d’Errico, and Marian Vanhaeren. 2015. <span>“Ornaments Reveal Resistance of North European Cultures to the Spread of Farming.”</span> <em>PLOS ONE</em> 10 (4): e0121166. <a href="https://doi.org/10.1371/journal.pone.0121166">https://doi.org/10.1371/journal.pone.0121166</a>.
</div>
<div id="ref-Sauvet_2018" class="csl-entry" role="listitem">
Sauvet, Georges, Raphaëlle Bourrillon, Diego Garate, Stéphane Petrognani, Olivia Rivero, Eric Robert, and Gilles Tosello. 2018. <span>“The Function of Graphic Signs in Prehistoric Societies: The Case of Cantabrian Quadrilateral Signs.”</span> <em>Quaternary International</em>, SI: Role of art in prehistory-UISPP2014, 491 (October): 99–109. <a href="https://doi.org/10.1016/j.quaint.2017.01.039">https://doi.org/10.1016/j.quaint.2017.01.039</a>.
</div>
<div id="ref-Mantel_Smouse" class="csl-entry" role="listitem">
Smouse, Peter E., and Jeffrey C. Long. 1992. <span>“Matrix Correlation Analysis in Anthropology and Genetics.”</span> <em>American Journal of Physical Anthropology</em> 35 (S15): 187–213. https://doi.org/<a href="https://doi.org/10.1002/ajpa.1330350608">https://doi.org/10.1002/ajpa.1330350608</a>.
</div>
<div id="ref-Tartar_2012" class="csl-entry" role="listitem">
Tartar, Elise. 2012. <span>“The Recognition of a New Type of Bone Tools in Early Aurignacian Assemblages: Implications for Understanding the Appearance of Osseous Technology in Europe.”</span> <em>Journal of Archaeological Science</em> 39 (7): 2348–60. <a href="https://doi.org/10.1016/j.jas.2012.02.003">https://doi.org/10.1016/j.jas.2012.02.003</a>.
</div>
<div id="ref-Tejero_Grimaldi_2015" class="csl-entry" role="listitem">
Tejero, José-Miguel, and Stefano Grimaldi. 2015. <span>“Assessing Bone and Antler Exploitation at Riparo Mochi (Balzi Rossi, Italy): Implications for the Characterization of the Aurignacian in South-Western Europe.”</span> <em>Journal of Archaeological Science</em> 61 (September): 59–77. <a href="https://doi.org/10.1016/j.jas.2015.05.003">https://doi.org/10.1016/j.jas.2015.05.003</a>.
</div>
<div id="ref-texier2010howiesons" class="csl-entry" role="listitem">
Texier, Pierre-Jean, Guillaume Porraz, John Parkington, Jean-Philippe Rigaud, Cedric Poggenpoel, Christopher Miller, Chantal Tribolo, et al. 2010. <span>“A Howiesons Poort Tradition of Engraving Ostrich Eggshell Containers Dated to 60,000 Years Ago at Diepkloof Rock Shelter, South Africa.”</span> <em>Proceedings of the National Academy of Sciences</em> 107 (14): 6180–85.
</div>
<div id="ref-Vanhaeren_2005" class="csl-entry" role="listitem">
Vanhaeren, Marian. 2005. <span>“Speaking with Beads: The Evolutionary Significance of Personal Ornaments.”</span> In <em>From Tools to Symbols: From Early Hominids to Modern Humans</em>, edited by Francesco d’Errico and LucindaEditors Backwell, 525–54. Wits University Press.
</div>
<div id="ref-Vanhaeren_d" class="csl-entry" role="listitem">
Vanhaeren, Marian, and Francesco d’Errico. 2006. <span>“Aurignacian Ethno-Linguistic Geography of Europe Revealed by Personal Ornaments.”</span> <em>Journal of Archaeological Science</em> 33 (8): 1105–28. <a href="https://doi.org/10.1016/j.jas.2005.11.017">https://doi.org/10.1016/j.jas.2005.11.017</a>.
</div>
<div id="ref-Whallon_2006" class="csl-entry" role="listitem">
Whallon, Robert. 2006. <span>“Social Networks and Information: Non-<span>‘Utilitarian’</span> Mobility Among Hunter-Gatherers.”</span> <em>Journal of Anthropological Archaeology</em>, Mesolithic mobility, exchange, and interaction, 25 (2): 259–70. <a href="https://doi.org/10.1016/j.jaa.2005.11.004">https://doi.org/10.1016/j.jaa.2005.11.004</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>